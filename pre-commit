#!/bin/bash

runValue=0
function verifyShellScripts()
 {
         file=$1
         op=$(shellcheck $file)
         res=$?
         if [ "$res" -ne "0" ] ; then
        	 echo "$file: failed check"
         	 echo "$op"
                 runValue=1
         fi;
	return $runValue
 }

function verifyPythonScripts()
{
	file=$1 
	check=$(pylint $file)
	result=$?
	if [ "$result" -ne "0" ] ; then 
		echo "$file: failed check"
		echo "$check"
		runValue=1
	fi;
	return $runValue 
}

for i in `git diff --cached --name-only --diff-filter=ACM`; do
	input=${i:(-3)}
	if [ "$input" == ".sh" ] ; then 
		verifyShellScripts $i
	elif [ "$input" == ".py" ] ; then
		verifyPythonScripts $i
	fi;
done

if [ "$runValue" -eq "1" ] ; then
	 exit 1
else
	 exit 0
fi;
